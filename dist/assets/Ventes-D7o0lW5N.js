import{r as o,j as m,M as dt,R,e as He,u as mt,l as ft,d as j,n as O}from"./index-DHz37_S4.js";import{F as pt,a as Be,b as ht}from"./TrashIcon-Bet72WXf.js";const qe={nom:"",capacite:"",couverts:""},vt=({isOpen:e,onClose:t,mode:r,initialValues:n,onSubmit:a,showCouvertsField:s=!1})=>{const[l,u]=o.useState(qe),[i,c]=o.useState({}),[d,h]=o.useState(null),[g,f]=o.useState(!1),b=o.useMemo(()=>r==="create"?"Ajouter une table":"Modifier la table",[r]);o.useEffect(()=>{if(!e){u(qe),c({}),h(null),f(!1);return}const p={nom:(n==null?void 0:n.nom)??"",capacite:n!=null&&n.capacite?String(n.capacite):"",couverts:s&&(n==null?void 0:n.couverts)!==void 0?String(n.couverts):""};u(p),c({}),h(null)},[n==null?void 0:n.capacite,n==null?void 0:n.couverts,n==null?void 0:n.nom,e,s]);const v=p=>{const{name:S,value:I}=p.target;u(y=>({...y,[S]:I}))},x=()=>{const p={},S=l.nom.trim(),I=l.capacite.trim();S||(p.nom="Le nom est requis.");let y=null;if(!I)p.capacite="La capacité est requise.";else{const F=Number(I);!Number.isInteger(F)||F<=0?p.capacite="La capacité doit être un entier positif.":y=F}if(s){const F=l.couverts.trim();if(!F)p.couverts="Le nombre de couverts est requis.";else{const A=Number(F);!Number.isInteger(A)||A<=0?p.couverts="Les couverts doivent être un entier positif.":y!==null&&A>y&&(p.couverts="Les couverts ne peuvent pas dépasser la capacité.")}}return p},M=async p=>{p.preventDefault(),c({}),h(null);const S=x();if(Object.keys(S).length>0){c(S);return}const I={nom:l.nom.trim(),capacite:Number(l.capacite.trim())};if(s){const y=l.couverts.trim();y&&(I.couverts=Number(y))}f(!0);try{await a(I)}catch(y){const F=y instanceof Error&&y.message?y.message:"Une erreur est survenue. Veuillez réessayer.";h(F)}finally{f(!1)}};return m.jsx(dt,{isOpen:e,onClose:t,title:b,size:"md",children:m.jsxs("form",{onSubmit:M,className:"space-y-5",children:[d&&m.jsx("div",{className:"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:d}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"table-name",className:"block text-sm font-medium text-gray-700",children:"Nom de la table"}),m.jsx("input",{id:"table-name",name:"nom",type:"text",className:"ui-input mt-1",value:l.nom,onChange:v,disabled:g,placeholder:"Ex. Terrasse 1",autoFocus:!0}),i.nom&&m.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.nom})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"table-capacity",className:"block text-sm font-medium text-gray-700",children:"Capacité (nombre de places)"}),m.jsx("input",{id:"table-capacity",name:"capacite",type:"number",min:1,className:"ui-input mt-1",value:l.capacite,onChange:v,disabled:g,placeholder:"Ex. 4"}),i.capacite&&m.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.capacite})]}),s&&m.jsxs("div",{children:[m.jsx("label",{htmlFor:"table-couverts",className:"block text-sm font-medium text-gray-700",children:"Couverts (actuels)"}),m.jsx("input",{id:"table-couverts",name:"couverts",type:"number",min:1,className:"ui-input mt-1",value:l.couverts,onChange:v,disabled:g,placeholder:"Ex. 2"}),i.couverts&&m.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.couverts})]}),m.jsxs("div",{className:"flex flex-col gap-3 pt-2 sm:flex-row",children:[m.jsx("button",{type:"button",onClick:t,className:"w-full ui-btn-secondary py-3",disabled:g,children:"Annuler"}),m.jsx("button",{type:"submit",className:"w-full ui-btn-primary py-3 disabled:opacity-60",disabled:g,children:g?"Enregistrement...":"Enregistrer"})]})]})})},bt=({isOpen:e,onClose:t,table:r,order:n,onCreateOrder:a,onUpdateOrder:s,onAddOrderItem:l,onUpdateOrderItem:u,onDeleteOrderItem:i,onUpdateOrderItemStatus:c,onUpdateOrderKitchenStatus:d,onUpdateOrderStatus:h,onUpdateOrderPaymentStatus:g,onLinkOrderToTable:f,onUnlinkOrderFromTable:b})=>e?m.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full",id:"my-modal",children:m.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:m.jsxs("div",{className:"mt-3 text-center",children:[m.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:["Commande pour la table ",r.number]}),m.jsxs("div",{className:"mt-2 px-7 py-3",children:[m.jsx("p",{className:"text-sm text-gray-500",children:"Contenu de la commande ici..."}),n?m.jsx("div",{children:m.jsxs("p",{children:["Order ID: ",n.id]})}):m.jsx("button",{onClick:()=>a(r.id,1),className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded",children:"Créer une nouvelle commande"})]}),m.jsx("div",{className:"items-center px-4 py-3",children:m.jsx("button",{id:"ok-btn",onClick:t,className:"px-4 py-2 bg-brand-primary text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-brand-dark focus:outline-none focus:ring-2 focus:ring-brand-primary",children:"Fermer"})})]})})}):null;function gt({title:e,titleId:t,...r},n){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?o.createElement("title",{id:t},e):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const yt=o.forwardRef(gt);var xt=Object.defineProperty,wt=(e,t,r)=>t in e?xt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,xe=(e,t,r)=>(wt(e,typeof t!="symbol"?t+"":t,r),r);let Et=class{constructor(){xe(this,"current",this.detect()),xe(this,"handoffState","pending"),xe(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},z=new Et,L=(e,t)=>{z.isServer?o.useEffect(e,t):o.useLayoutEffect(e,t)};function Q(e){let t=o.useRef(e);return L(()=>{t.current=e},[e]),t}let C=function(e){let t=Q(e);return R.useCallback((...r)=>t.current(...r),[t])};function St(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function H(){let e=[],t={addEventListener(r,n,a,s){return r.addEventListener(n,a,s),t.add(()=>r.removeEventListener(n,a,s))},requestAnimationFrame(...r){let n=requestAnimationFrame(...r);return t.add(()=>cancelAnimationFrame(n))},nextFrame(...r){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...r))},setTimeout(...r){let n=setTimeout(...r);return t.add(()=>clearTimeout(n))},microTask(...r){let n={current:!0};return St(()=>{n.current&&r[0]()}),t.add(()=>{n.current=!1})},style(r,n,a){let s=r.style.getPropertyValue(n);return Object.assign(r.style,{[n]:a}),this.add(()=>{Object.assign(r.style,{[n]:s})})},group(r){let n=H();return r(n),this.add(()=>n.dispose())},add(r){return e.push(r),()=>{let n=e.indexOf(r);if(n>=0)for(let a of e.splice(n,1))a()}},dispose(){for(let r of e.splice(0))r()}};return t}function ie(){let[e]=o.useState(H);return o.useEffect(()=>()=>e.dispose(),[e]),e}function Ot(){let e=typeof document>"u";return"useSyncExternalStore"in He?(t=>t.useSyncExternalStore)(He)(()=>()=>{},()=>!1,()=>!e):!1}function je(){let e=Ot(),[t,r]=o.useState(z.isHandoffComplete);return t&&z.isHandoffComplete===!1&&r(!1),o.useEffect(()=>{t!==!0&&r(!0)},[t]),o.useEffect(()=>z.handoff(),[]),e?!1:t}var Ke;let Fe=(Ke=R.useId)!=null?Ke:function(){let e=je(),[t,r]=R.useState(e?()=>z.nextId():null);return L(()=>{t===null&&r(z.nextId())},[t]),t!=null?""+t:void 0};function $(e,t,...r){if(e in t){let a=t[e];return typeof a=="function"?a(...r):a}let n=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(a=>`"${a}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,$),n}function ce(e){return z.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}let Ne=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var Ie=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(Ie||{}),Nt=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(Nt||{}),It=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(It||{});function Ze(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(Ne)).sort((t,r)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(r.tabIndex||Number.MAX_SAFE_INTEGER)))}var Ce=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Ce||{});function ke(e,t=0){var r;return e===((r=ce(e))==null?void 0:r.body)?!1:$(t,{0(){return e.matches(Ne)},1(){let n=e;for(;n!==null;){if(n.matches(Ne))return!0;n=n.parentElement}return!1}})}function Je(e){let t=ce(e);H().nextFrame(()=>{t&&!ke(t.activeElement,0)&&jt(e)})}var Tt=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(Tt||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function jt(e){e==null||e.focus({preventScroll:!0})}let Ft=["textarea","input"].join(",");function Ct(e){var t,r;return(r=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,Ft))!=null?r:!1}function Ve(e,t=r=>r){return e.slice().sort((r,n)=>{let a=t(r),s=t(n);if(a===null||s===null)return 0;let l=a.compareDocumentPosition(s);return l&Node.DOCUMENT_POSITION_FOLLOWING?-1:l&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function kt(e,t){return Rt(Ze(),t,{relativeTo:e})}function Rt(e,t,{sorted:r=!0,relativeTo:n=null,skipElements:a=[]}={}){let s=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,l=Array.isArray(e)?r?Ve(e):e:Ze(e);a.length>0&&l.length>1&&(l=l.filter(f=>!a.includes(f))),n=n??s.activeElement;let u=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),i=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,l.indexOf(n))-1;if(t&4)return Math.max(0,l.indexOf(n))+1;if(t&8)return l.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=t&32?{preventScroll:!0}:{},d=0,h=l.length,g;do{if(d>=h||d+h<=0)return 0;let f=i+d;if(t&16)f=(f+h)%h;else{if(f<0)return 3;if(f>=h)return 1}g=l[f],g==null||g.focus(c),d+=u}while(g!==s.activeElement);return t&6&&Ct(g)&&g.select(),2}function Mt(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Pt(){return/Android/gi.test(window.navigator.userAgent)}function $t(){return Mt()||Pt()}function se(e,t,r){let n=Q(t);o.useEffect(()=>{function a(s){n.current(s)}return document.addEventListener(e,a,r),()=>document.removeEventListener(e,a,r)},[e,r])}function At(e,t,r){let n=Q(t);o.useEffect(()=>{function a(s){n.current(s)}return window.addEventListener(e,a,r),()=>window.removeEventListener(e,a,r)},[e,r])}function Lt(e,t,r=!0){let n=o.useRef(!1);o.useEffect(()=>{requestAnimationFrame(()=>{n.current=r})},[r]);function a(l,u){if(!n.current||l.defaultPrevented)return;let i=u(l);if(i===null||!i.getRootNode().contains(i)||!i.isConnected)return;let c=(function d(h){return typeof h=="function"?d(h()):Array.isArray(h)||h instanceof Set?h:[h]})(e);for(let d of c){if(d===null)continue;let h=d instanceof HTMLElement?d:d.current;if(h!=null&&h.contains(i)||l.composed&&l.composedPath().includes(h))return}return!ke(i,Ce.Loose)&&i.tabIndex!==-1&&l.preventDefault(),t(l,i)}let s=o.useRef(null);se("pointerdown",l=>{var u,i;n.current&&(s.current=((i=(u=l.composedPath)==null?void 0:u.call(l))==null?void 0:i[0])||l.target)},!0),se("mousedown",l=>{var u,i;n.current&&(s.current=((i=(u=l.composedPath)==null?void 0:u.call(l))==null?void 0:i[0])||l.target)},!0),se("click",l=>{$t()||s.current&&(a(l,()=>s.current),s.current=null)},!0),se("touchend",l=>a(l,()=>l.target instanceof HTMLElement?l.target:null),!0),At("blur",l=>a(l,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function Dt(...e){return o.useMemo(()=>ce(...e),[...e])}function Qe(e){var t;if(e.type)return e.type;let r=(t=e.as)!=null?t:"button";if(typeof r=="string"&&r.toLowerCase()==="button")return"button"}function Ut(e,t){let[r,n]=o.useState(()=>Qe(e));return L(()=>{n(Qe(e))},[e.type,e.as]),L(()=>{r||t.current&&t.current instanceof HTMLButtonElement&&!t.current.hasAttribute("type")&&n("button")},[r,t]),r}let _t=Symbol();function Z(...e){let t=o.useRef(e);o.useEffect(()=>{t.current=e},[e]);let r=C(n=>{for(let a of t.current)a!=null&&(typeof a=="function"?a(n):a.current=n)});return e.every(n=>n==null||(n==null?void 0:n[_t]))?void 0:r}function Ge(e){return[e.screenX,e.screenY]}function Ht(){let e=o.useRef([-1,-1]);return{wasMoved(t){let r=Ge(t);return e.current[0]===r[0]&&e.current[1]===r[1]?!1:(e.current=r,!0)},update(t){e.current=Ge(t)}}}function Bt({container:e,accept:t,walk:r,enabled:n=!0}){let a=o.useRef(t),s=o.useRef(r);o.useEffect(()=>{a.current=t,s.current=r},[t,r]),L(()=>{if(!e||!n)return;let l=ce(e);if(!l)return;let u=a.current,i=s.current,c=Object.assign(h=>u(h),{acceptNode:u}),d=l.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,c,!1);for(;d.nextNode();)i(d.currentNode)},[e,n,a,s])}function le(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}var ue=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(ue||{}),K=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(K||{});function J({ourProps:e,theirProps:t,slot:r,defaultTag:n,features:a,visible:s=!0,name:l,mergeRefs:u}){u=u??qt;let i=et(t,e);if(s)return oe(i,r,n,l,u);let c=a??0;if(c&2){let{static:d=!1,...h}=i;if(d)return oe(h,r,n,l,u)}if(c&1){let{unmount:d=!0,...h}=i;return $(d?0:1,{0(){return null},1(){return oe({...h,hidden:!0,style:{display:"none"}},r,n,l,u)}})}return oe(i,r,n,l,u)}function oe(e,t={},r,n,a){let{as:s=r,children:l,refName:u="ref",...i}=we(e,["unmount","static"]),c=e.ref!==void 0?{[u]:e.ref}:{},d=typeof l=="function"?l(t):l;"className"in i&&i.className&&typeof i.className=="function"&&(i.className=i.className(t));let h={};if(t){let g=!1,f=[];for(let[b,v]of Object.entries(t))typeof v=="boolean"&&(g=!0),v===!0&&f.push(b);g&&(h["data-headlessui-state"]=f.join(" "))}if(s===o.Fragment&&Object.keys(We(i)).length>0){if(!o.isValidElement(d)||Array.isArray(d)&&d.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${n} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(i).map(v=>`  - ${v}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(v=>`  - ${v}`).join(`
`)].join(`
`));let g=d.props,f=typeof(g==null?void 0:g.className)=="function"?(...v)=>le(g==null?void 0:g.className(...v),i.className):le(g==null?void 0:g.className,i.className),b=f?{className:f}:{};return o.cloneElement(d,Object.assign({},et(d.props,We(we(i,["ref"]))),h,c,{ref:a(d.ref,c.ref)},b))}return o.createElement(s,Object.assign({},we(i,["ref"]),s!==o.Fragment&&c,s!==o.Fragment&&h),d)}function qt(...e){return e.every(t=>t==null)?void 0:t=>{for(let r of e)r!=null&&(typeof r=="function"?r(t):r.current=t)}}function et(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},r={};for(let n of e)for(let a in n)a.startsWith("on")&&typeof n[a]=="function"?(r[a]!=null||(r[a]=[]),r[a].push(n[a])):t[a]=n[a];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(r).map(n=>[n,void 0])));for(let n in r)Object.assign(t,{[n](a,...s){let l=r[n];for(let u of l){if((a instanceof Event||(a==null?void 0:a.nativeEvent)instanceof Event)&&a.defaultPrevented)return;u(a,...s)}}});return t}function X(e){var t;return Object.assign(o.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function We(e){let t=Object.assign({},e);for(let r in t)t[r]===void 0&&delete t[r];return t}function we(e,t=[]){let r=Object.assign({},e);for(let n of t)n in r&&delete r[n];return r}let Re=o.createContext(null);Re.displayName="OpenClosedContext";var P=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(P||{});function Me(){return o.useContext(Re)}function tt({value:e,children:t}){return R.createElement(Re.Provider,{value:e},t)}function Kt(e){let t=e.parentElement,r=null;for(;t&&!(t instanceof HTMLFieldSetElement);)t instanceof HTMLLegendElement&&(r=t),t=t.parentElement;let n=(t==null?void 0:t.getAttribute("disabled"))==="";return n&&Qt(r)?!1:n}function Qt(e){if(!e)return!1;let t=e.previousElementSibling;for(;t!==null;){if(t instanceof HTMLLegendElement)return!1;t=t.previousElementSibling}return!0}function Gt(e){throw new Error("Unexpected object: "+e)}var D=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(D||{});function Wt(e,t){let r=t.resolveItems();if(r.length<=0)return null;let n=t.resolveActiveIndex(),a=n??-1;switch(e.focus){case 0:{for(let s=0;s<r.length;++s)if(!t.resolveDisabled(r[s],s,r))return s;return n}case 1:{for(let s=a-1;s>=0;--s)if(!t.resolveDisabled(r[s],s,r))return s;return n}case 2:{for(let s=a+1;s<r.length;++s)if(!t.resolveDisabled(r[s],s,r))return s;return n}case 3:{for(let s=r.length-1;s>=0;--s)if(!t.resolveDisabled(r[s],s,r))return s;return n}case 4:{for(let s=0;s<r.length;++s)if(t.resolveId(r[s],s,r)===e.id)return s;return n}case 5:return null;default:Gt(e)}}var k=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(k||{});function Pe(){let e=o.useRef(!1);return L(()=>(e.current=!0,()=>{e.current=!1}),[]),e}let ze=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function Xe(e){var t,r;let n=(t=e.innerText)!=null?t:"",a=e.cloneNode(!0);if(!(a instanceof HTMLElement))return n;let s=!1;for(let u of a.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))u.remove(),s=!0;let l=s?(r=a.innerText)!=null?r:"":n;return ze.test(l)&&(l=l.replace(ze,"")),l}function zt(e){let t=e.getAttribute("aria-label");if(typeof t=="string")return t.trim();let r=e.getAttribute("aria-labelledby");if(r){let n=r.split(" ").map(a=>{let s=document.getElementById(a);if(s){let l=s.getAttribute("aria-label");return typeof l=="string"?l.trim():Xe(s).trim()}return null}).filter(Boolean);if(n.length>0)return n.join(", ")}return Xe(e).trim()}function Xt(e){let t=o.useRef(""),r=o.useRef("");return C(()=>{let n=e.current;if(!n)return"";let a=n.innerText;if(t.current===a)return r.current;let s=zt(n).trim().toLowerCase();return t.current=a,r.current=s,s})}var Yt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Yt||{}),Zt=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Zt||{}),Jt=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e))(Jt||{});function Ee(e,t=r=>r){let r=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,n=Ve(t(e.items.slice()),s=>s.dataRef.current.domRef.current),a=r?n.indexOf(r):null;return a===-1&&(a=null),{items:n,activeItemIndex:a}}let Vt={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,t)=>{var r;let n=Ee(e),a=Wt(t,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:s=>s.id,resolveDisabled:s=>s.dataRef.current.disabled});return{...e,...n,searchQuery:"",activeItemIndex:a,activationTrigger:(r=t.trigger)!=null?r:1}},3:(e,t)=>{let r=e.searchQuery!==""?0:1,n=e.searchQuery+t.value.toLowerCase(),a=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+r).concat(e.items.slice(0,e.activeItemIndex+r)):e.items).find(l=>{var u;return((u=l.dataRef.current.textValue)==null?void 0:u.startsWith(n))&&!l.dataRef.current.disabled}),s=a?e.items.indexOf(a):-1;return s===-1||s===e.activeItemIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeItemIndex:s,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,t)=>{let r=Ee(e,n=>[...n,{id:t.id,dataRef:t.dataRef}]);return{...e,...r}},6:(e,t)=>{let r=Ee(e,n=>{let a=n.findIndex(s=>s.id===t.id);return a!==-1&&n.splice(a,1),n});return{...e,...r,activationTrigger:1}}},$e=o.createContext(null);$e.displayName="MenuContext";function de(e){let t=o.useContext($e);if(t===null){let r=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,de),r}return t}function er(e,t){return $(t.type,Vt,e,t)}let tr=o.Fragment;function rr(e,t){let{__demoMode:r=!1,...n}=e,a=o.useReducer(er,{__demoMode:r,menuState:r?0:1,buttonRef:o.createRef(),itemsRef:o.createRef(),items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:s,itemsRef:l,buttonRef:u},i]=a,c=Z(t);Lt([u,l],(f,b)=>{var v;i({type:1}),ke(b,Ce.Loose)||(f.preventDefault(),(v=u.current)==null||v.focus())},s===0);let d=C(()=>{i({type:1})}),h=o.useMemo(()=>({open:s===0,close:d}),[s,d]),g={ref:c};return R.createElement($e.Provider,{value:a},R.createElement(tt,{value:$(s,{0:P.Open,1:P.Closed})},J({ourProps:g,theirProps:n,slot:h,defaultTag:tr,name:"Menu"})))}let nr="button";function ar(e,t){var r;let n=Fe(),{id:a=`headlessui-menu-button-${n}`,...s}=e,[l,u]=de("Menu.Button"),i=Z(l.buttonRef,t),c=ie(),d=C(v=>{switch(v.key){case k.Space:case k.Enter:case k.ArrowDown:v.preventDefault(),v.stopPropagation(),u({type:0}),c.nextFrame(()=>u({type:2,focus:D.First}));break;case k.ArrowUp:v.preventDefault(),v.stopPropagation(),u({type:0}),c.nextFrame(()=>u({type:2,focus:D.Last}));break}}),h=C(v=>{switch(v.key){case k.Space:v.preventDefault();break}}),g=C(v=>{if(Kt(v.currentTarget))return v.preventDefault();e.disabled||(l.menuState===0?(u({type:1}),c.nextFrame(()=>{var x;return(x=l.buttonRef.current)==null?void 0:x.focus({preventScroll:!0})})):(v.preventDefault(),u({type:0})))}),f=o.useMemo(()=>({open:l.menuState===0}),[l]),b={ref:i,id:a,type:Ut(e,l.buttonRef),"aria-haspopup":"menu","aria-controls":(r=l.itemsRef.current)==null?void 0:r.id,"aria-expanded":l.menuState===0,onKeyDown:d,onKeyUp:h,onClick:g};return J({ourProps:b,theirProps:s,slot:f,defaultTag:nr,name:"Menu.Button"})}let sr="div",or=ue.RenderStrategy|ue.Static;function lr(e,t){var r,n;let a=Fe(),{id:s=`headlessui-menu-items-${a}`,...l}=e,[u,i]=de("Menu.Items"),c=Z(u.itemsRef,t),d=Dt(u.itemsRef),h=ie(),g=Me(),f=g!==null?(g&P.Open)===P.Open:u.menuState===0;o.useEffect(()=>{let p=u.itemsRef.current;p&&u.menuState===0&&p!==(d==null?void 0:d.activeElement)&&p.focus({preventScroll:!0})},[u.menuState,u.itemsRef,d]),Bt({container:u.itemsRef.current,enabled:u.menuState===0,accept(p){return p.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:p.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(p){p.setAttribute("role","none")}});let b=C(p=>{var S,I;switch(h.dispose(),p.key){case k.Space:if(u.searchQuery!=="")return p.preventDefault(),p.stopPropagation(),i({type:3,value:p.key});case k.Enter:if(p.preventDefault(),p.stopPropagation(),i({type:1}),u.activeItemIndex!==null){let{dataRef:y}=u.items[u.activeItemIndex];(I=(S=y.current)==null?void 0:S.domRef.current)==null||I.click()}Je(u.buttonRef.current);break;case k.ArrowDown:return p.preventDefault(),p.stopPropagation(),i({type:2,focus:D.Next});case k.ArrowUp:return p.preventDefault(),p.stopPropagation(),i({type:2,focus:D.Previous});case k.Home:case k.PageUp:return p.preventDefault(),p.stopPropagation(),i({type:2,focus:D.First});case k.End:case k.PageDown:return p.preventDefault(),p.stopPropagation(),i({type:2,focus:D.Last});case k.Escape:p.preventDefault(),p.stopPropagation(),i({type:1}),H().nextFrame(()=>{var y;return(y=u.buttonRef.current)==null?void 0:y.focus({preventScroll:!0})});break;case k.Tab:p.preventDefault(),p.stopPropagation(),i({type:1}),H().nextFrame(()=>{kt(u.buttonRef.current,p.shiftKey?Ie.Previous:Ie.Next)});break;default:p.key.length===1&&(i({type:3,value:p.key}),h.setTimeout(()=>i({type:4}),350));break}}),v=C(p=>{switch(p.key){case k.Space:p.preventDefault();break}}),x=o.useMemo(()=>({open:u.menuState===0}),[u]),M={"aria-activedescendant":u.activeItemIndex===null||(r=u.items[u.activeItemIndex])==null?void 0:r.id,"aria-labelledby":(n=u.buttonRef.current)==null?void 0:n.id,id:s,onKeyDown:b,onKeyUp:v,role:"menu",tabIndex:0,ref:c};return J({ourProps:M,theirProps:l,slot:x,defaultTag:sr,features:or,visible:f,name:"Menu.Items"})}let ur=o.Fragment;function ir(e,t){let r=Fe(),{id:n=`headlessui-menu-item-${r}`,disabled:a=!1,...s}=e,[l,u]=de("Menu.Item"),i=l.activeItemIndex!==null?l.items[l.activeItemIndex].id===n:!1,c=o.useRef(null),d=Z(t,c);L(()=>{if(l.__demoMode||l.menuState!==0||!i||l.activationTrigger===0)return;let y=H();return y.requestAnimationFrame(()=>{var F,A;(A=(F=c.current)==null?void 0:F.scrollIntoView)==null||A.call(F,{block:"nearest"})}),y.dispose},[l.__demoMode,c,i,l.menuState,l.activationTrigger,l.activeItemIndex]);let h=Xt(c),g=o.useRef({disabled:a,domRef:c,get textValue(){return h()}});L(()=>{g.current.disabled=a},[g,a]),L(()=>(u({type:5,id:n,dataRef:g}),()=>u({type:6,id:n})),[g,n]);let f=C(()=>{u({type:1})}),b=C(y=>{if(a)return y.preventDefault();u({type:1}),Je(l.buttonRef.current)}),v=C(()=>{if(a)return u({type:2,focus:D.Nothing});u({type:2,focus:D.Specific,id:n})}),x=Ht(),M=C(y=>x.update(y)),p=C(y=>{x.wasMoved(y)&&(a||i||u({type:2,focus:D.Specific,id:n,trigger:0}))}),S=C(y=>{x.wasMoved(y)&&(a||i&&u({type:2,focus:D.Nothing}))}),I=o.useMemo(()=>({active:i,disabled:a,close:f}),[i,a,f]);return J({ourProps:{id:n,ref:d,role:"menuitem",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,disabled:void 0,onClick:b,onFocus:v,onPointerEnter:M,onMouseEnter:M,onPointerMove:p,onMouseMove:p,onPointerLeave:S,onMouseLeave:S},theirProps:s,slot:I,defaultTag:ur,name:"Menu.Item"})}let cr=X(rr),dr=X(ar),mr=X(lr),fr=X(ir),re=Object.assign(cr,{Button:dr,Items:mr,Item:fr});function pr(e=0){let[t,r]=o.useState(e),n=Pe(),a=o.useCallback(i=>{n.current&&r(c=>c|i)},[t,n]),s=o.useCallback(i=>!!(t&i),[t]),l=o.useCallback(i=>{n.current&&r(c=>c&~i)},[r,n]),u=o.useCallback(i=>{n.current&&r(c=>c^i)},[r]);return{flags:t,addFlag:a,hasFlag:s,removeFlag:l,toggleFlag:u}}function hr(e){let t={called:!1};return(...r)=>{if(!t.called)return t.called=!0,e(...r)}}function Se(e,...t){e&&t.length>0&&e.classList.add(...t)}function Oe(e,...t){e&&t.length>0&&e.classList.remove(...t)}function vr(e,t){let r=H();if(!e)return r.dispose;let{transitionDuration:n,transitionDelay:a}=getComputedStyle(e),[s,l]=[n,a].map(i=>{let[c=0]=i.split(",").filter(Boolean).map(d=>d.includes("ms")?parseFloat(d):parseFloat(d)*1e3).sort((d,h)=>h-d);return c}),u=s+l;if(u!==0){r.group(c=>{c.setTimeout(()=>{t(),c.dispose()},u),c.addEventListener(e,"transitionrun",d=>{d.target===d.currentTarget&&c.dispose()})});let i=r.addEventListener(e,"transitionend",c=>{c.target===c.currentTarget&&(t(),i())})}else t();return r.add(()=>t()),r.dispose}function br(e,t,r,n){let a=r?"enter":"leave",s=H(),l=n!==void 0?hr(n):()=>{};a==="enter"&&(e.removeAttribute("hidden"),e.style.display="");let u=$(a,{enter:()=>t.enter,leave:()=>t.leave}),i=$(a,{enter:()=>t.enterTo,leave:()=>t.leaveTo}),c=$(a,{enter:()=>t.enterFrom,leave:()=>t.leaveFrom});return Oe(e,...t.base,...t.enter,...t.enterTo,...t.enterFrom,...t.leave,...t.leaveFrom,...t.leaveTo,...t.entered),Se(e,...t.base,...u,...c),s.nextFrame(()=>{Oe(e,...t.base,...u,...c),Se(e,...t.base,...u,...i),vr(e,()=>(Oe(e,...t.base,...u),Se(e,...t.base,...t.entered),l()))}),s.dispose}function gr({immediate:e,container:t,direction:r,classes:n,onStart:a,onStop:s}){let l=Pe(),u=ie(),i=Q(r);L(()=>{e&&(i.current="enter")},[e]),L(()=>{let c=H();u.add(c.dispose);let d=t.current;if(d&&i.current!=="idle"&&l.current)return c.dispose(),a.current(i.current),c.add(br(d,n.current,i.current==="enter",()=>{c.dispose(),s.current(i.current)})),c.dispose},[r])}function q(e=""){return e.split(/\s+/).filter(t=>t.length>1)}let me=o.createContext(null);me.displayName="TransitionContext";var yr=(e=>(e.Visible="visible",e.Hidden="hidden",e))(yr||{});function xr(){let e=o.useContext(me);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function wr(){let e=o.useContext(fe);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let fe=o.createContext(null);fe.displayName="NestingContext";function pe(e){return"children"in e?pe(e.children):e.current.filter(({el:t})=>t.current!==null).filter(({state:t})=>t==="visible").length>0}function rt(e,t){let r=Q(e),n=o.useRef([]),a=Pe(),s=ie(),l=C((f,b=K.Hidden)=>{let v=n.current.findIndex(({el:x})=>x===f);v!==-1&&($(b,{[K.Unmount](){n.current.splice(v,1)},[K.Hidden](){n.current[v].state="hidden"}}),s.microTask(()=>{var x;!pe(n)&&a.current&&((x=r.current)==null||x.call(r))}))}),u=C(f=>{let b=n.current.find(({el:v})=>v===f);return b?b.state!=="visible"&&(b.state="visible"):n.current.push({el:f,state:"visible"}),()=>l(f,K.Unmount)}),i=o.useRef([]),c=o.useRef(Promise.resolve()),d=o.useRef({enter:[],leave:[],idle:[]}),h=C((f,b,v)=>{i.current.splice(0),t&&(t.chains.current[b]=t.chains.current[b].filter(([x])=>x!==f)),t==null||t.chains.current[b].push([f,new Promise(x=>{i.current.push(x)})]),t==null||t.chains.current[b].push([f,new Promise(x=>{Promise.all(d.current[b].map(([M,p])=>p)).then(()=>x())})]),b==="enter"?c.current=c.current.then(()=>t==null?void 0:t.wait.current).then(()=>v(b)):v(b)}),g=C((f,b,v)=>{Promise.all(d.current[b].splice(0).map(([x,M])=>M)).then(()=>{var x;(x=i.current.shift())==null||x()}).then(()=>v(b))});return o.useMemo(()=>({children:n,register:u,unregister:l,onStart:h,onStop:g,wait:c,chains:d}),[u,l,n,h,g,d,c])}function Er(){}let Sr=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function Ye(e){var t;let r={};for(let n of Sr)r[n]=(t=e[n])!=null?t:Er;return r}function Or(e){let t=o.useRef(Ye(e));return o.useEffect(()=>{t.current=Ye(e)},[e]),t}let Nr="div",nt=ue.RenderStrategy;function Ir(e,t){var r,n;let{beforeEnter:a,afterEnter:s,beforeLeave:l,afterLeave:u,enter:i,enterFrom:c,enterTo:d,entered:h,leave:g,leaveFrom:f,leaveTo:b,...v}=e,x=o.useRef(null),M=Z(x,t),p=(r=v.unmount)==null||r?K.Unmount:K.Hidden,{show:S,appear:I,initial:y}=xr(),[F,A]=o.useState(S?"visible":"hidden"),ne=wr(),{register:_,unregister:G}=ne;o.useEffect(()=>_(x),[_,x]),o.useEffect(()=>{if(p===K.Hidden&&x.current){if(S&&F!=="visible"){A("visible");return}return $(F,{hidden:()=>G(x),visible:()=>_(x)})}},[F,x,_,G,S,p]);let V=Q({base:q(v.className),enter:q(i),enterFrom:q(c),enterTo:q(d),entered:q(h),leave:q(g),leaveFrom:q(f),leaveTo:q(b)}),T=Or({beforeEnter:a,afterEnter:s,beforeLeave:l,afterLeave:u}),ee=je();o.useEffect(()=>{if(ee&&F==="visible"&&x.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[x,F,ee]);let he=y&&!I,ae=I&&S&&y,ve=!ee||he?"idle":S?"enter":"leave",W=pr(0),be=C(U=>$(U,{enter:()=>{W.addFlag(P.Opening),T.current.beforeEnter()},leave:()=>{W.addFlag(P.Closing),T.current.beforeLeave()},idle:()=>{}})),ge=C(U=>$(U,{enter:()=>{W.removeFlag(P.Opening),T.current.afterEnter()},leave:()=>{W.removeFlag(P.Closing),T.current.afterLeave()},idle:()=>{}})),Y=rt(()=>{A("hidden"),G(x)},ne),te=o.useRef(!1);gr({immediate:ae,container:x,classes:V,direction:ve,onStart:Q(U=>{te.current=!0,Y.onStart(x,U,be)}),onStop:Q(U=>{te.current=!1,Y.onStop(x,U,ge),U==="leave"&&!pe(Y)&&(A("hidden"),G(x))})});let B=v,ye={ref:M};return ae?B={...B,className:le(v.className,...V.current.enter,...V.current.enterFrom)}:te.current&&(B.className=le(v.className,(n=x.current)==null?void 0:n.className),B.className===""&&delete B.className),R.createElement(fe.Provider,{value:Y},R.createElement(tt,{value:$(F,{visible:P.Open,hidden:P.Closed})|W.flags},J({ourProps:ye,theirProps:B,defaultTag:Nr,features:nt,visible:F==="visible",name:"Transition.Child"})))}function Tr(e,t){let{show:r,appear:n=!1,unmount:a=!0,...s}=e,l=o.useRef(null),u=Z(l,t);je();let i=Me();if(r===void 0&&i!==null&&(r=(i&P.Open)===P.Open),![!0,!1].includes(r))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[c,d]=o.useState(r?"visible":"hidden"),h=rt(()=>{d("hidden")}),[g,f]=o.useState(!0),b=o.useRef([r]);L(()=>{g!==!1&&b.current[b.current.length-1]!==r&&(b.current.push(r),f(!1))},[b,r]);let v=o.useMemo(()=>({show:r,appear:n,initial:g}),[r,n,g]);o.useEffect(()=>{if(r)d("visible");else if(!pe(h))d("hidden");else{let S=l.current;if(!S)return;let I=S.getBoundingClientRect();I.x===0&&I.y===0&&I.width===0&&I.height===0&&d("hidden")}},[r,h]);let x={unmount:a},M=C(()=>{var S;g&&f(!1),(S=e.beforeEnter)==null||S.call(e)}),p=C(()=>{var S;g&&f(!1),(S=e.beforeLeave)==null||S.call(e)});return R.createElement(fe.Provider,{value:h},R.createElement(me.Provider,{value:v},J({ourProps:{...x,as:o.Fragment,children:R.createElement(at,{ref:u,...x,...s,beforeEnter:M,beforeLeave:p})},theirProps:{},defaultTag:o.Fragment,features:nt,visible:c==="visible",name:"Transition"})))}function jr(e,t){let r=o.useContext(me)!==null,n=Me()!==null;return R.createElement(R.Fragment,null,!r&&n?R.createElement(Te,{ref:t,...e}):R.createElement(at,{ref:t,...e}))}let Te=X(Tr),at=X(Ir),Fr=X(jr),Cr=Object.assign(Te,{Child:Fr,Root:Te});const kr=R.memo(({table:e,openOrderModal:t,openEditTableModal:r,handleDeleteTable:n,canManageTables:a,canManageOrders:s})=>{const l=o.useMemo(()=>{switch(e.status){case"occupied":return"bg-red-100 text-red-800";case"waiting":return"bg-yellow-100 text-yellow-800";case"available":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},[e.status]);return m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 flex flex-col justify-between transform transition duration-300 hover:scale-105","aria-label":`Table ${e.number}, statut: ${e.status}`,tabIndex:0,children:[m.jsxs("div",{children:[m.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Table ",e.number]}),m.jsxs("p",{className:`inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium ${l}`,children:[e.status==="occupied"&&"Occupée",e.status==="waiting"&&"En attente",e.status==="available"&&"Disponible",e.status==="cleaning"&&"Nettoyage"]}),e.current_order_id&&m.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Commande actuelle: ",e.current_order_id]}),e.couverts&&m.jsxs("p",{className:"text-sm text-gray-600",children:["Couverts: ",e.couverts]})]}),m.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[s&&m.jsx("button",{onClick:()=>t(e),className:"p-2 rounded-full bg-brand-primary text-white hover:bg-brand-dark focus:outline-none focus:ring-2 focus:ring-brand-primary focus:ring-opacity-50","aria-label":`Voir ou gérer la commande de la table ${e.number}`,children:m.jsx(yt,{className:"h-5 w-5"})}),a&&m.jsxs(re,{as:"div",className:"relative inline-block text-left",children:[m.jsx("div",{children:m.jsx(re.Button,{className:"inline-flex justify-center w-full rounded-full p-2 bg-gray-100 text-gray-600 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 focus:ring-brand-primary","aria-label":`Options pour la table ${e.number}`,children:m.jsx(Be,{className:"h-5 w-5"})})}),m.jsx(Cr,{as:o.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:m.jsx(re.Items,{className:"origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-10",children:m.jsxs("div",{className:"py-1",children:[m.jsx(re.Item,{children:({active:u})=>m.jsxs("button",{onClick:()=>r(e),className:`${u?"bg-gray-100 text-gray-900":"text-gray-700"} flex px-4 py-2 text-sm w-full text-left`,"aria-label":`Modifier les détails de la table ${e.number}`,children:[m.jsx(Be,{className:"mr-3 h-5 w-5 text-gray-400","aria-hidden":"true"}),"Modifier la table"]})}),m.jsx(re.Item,{children:({active:u})=>m.jsxs("button",{onClick:()=>n(e.id),className:`${u?"bg-gray-100 text-gray-900":"text-gray-700"} flex px-4 py-2 text-sm w-full text-left`,"aria-label":`Supprimer la table ${e.number}`,children:[m.jsx(ht,{className:"mr-3 h-5 w-5 text-gray-400","aria-hidden":"true"}),"Supprimer la table"]})})]})})})]})]})]})}),$r=()=>{var Ae,Le,De,Ue;const{role:e}=mt();ft();const[t,r]=o.useState([]),[n,a]=o.useState(!0),[s,l]=o.useState(null),[u,i]=o.useState(!1),[c,d]=o.useState(!1),[h,g]=o.useState(null),[f,b]=o.useState(null),[v,x]=o.useState("add"),[M,p]=o.useState({}),[S,I]=o.useState(!1),[y,F]=o.useState(0),[A,ne]=o.useState(0),_=12,G=(Le=(Ae=e==null?void 0:e.permissions)==null?void 0:Ae["/ventes"])==null?void 0:Le.write,V=(Ue=(De=e==null?void 0:e.permissions)==null?void 0:De["/ventes"])==null?void 0:Ue.write,T=o.useCallback(async w=>{a(!0);try{const{data:E,count:N}=await j.getTables(w*_,_);r(E||[]),ne(Math.ceil((N||0)/_))}catch{O.showError("Erreur lors du chargement des tables."),l("Impossible de charger les tables.")}finally{a(!1)}},[_]);o.useEffect(()=>{T(y)},[T,y]);const ee=o.useCallback(async w=>{a(!0);try{v==="add"?(await j.createTable(w),O.showSuccess("Table ajoutée avec succès !")):h&&(await j.updateTable(h.id,w),O.showSuccess("Table mise à jour avec succès !")),i(!1),T(y)}catch{O.showError("Erreur lors de l'enregistrement de la table.")}finally{a(!1)}},[v,h,T,y]),he=o.useCallback(async w=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer cette table ?")){a(!0);try{await j.deleteTable(w),O.showSuccess("Table supprimée avec succès !"),T(y)}catch{O.showError("Erreur lors de la suppression de la table.")}finally{a(!1)}}},[T,y]),ae=o.useCallback(()=>{x("add"),p({}),I(!1),i(!0)},[]),ve=o.useCallback(w=>{x("edit"),g(w),p(w),I(!0),i(!0)},[]),W=o.useCallback(async w=>{if(g(w),w.current_order_id)try{const E=await j.getOrderById(w.current_order_id);b(E)}catch{O.showError("Erreur lors du chargement de la commande."),b(null)}else b(null);d(!0)},[]),be=o.useCallback(()=>{d(!1),g(null),b(null),T(y)},[T,y]),ge=o.useCallback(async(w,E)=>{try{const N=await j.createOrder(w,E);O.showSuccess("Commande créée avec succès !"),b(N),T(y)}catch{O.showError("Erreur lors de la création de la commande.")}},[T,y]),Y=o.useCallback(async(w,E)=>{try{const N=await j.updateOrder(w,E);O.showSuccess("Commande mise à jour avec succès !"),b(N),T(y)}catch{O.showError("Erreur lors de la mise à jour de la commande.")}},[T,y]),te=o.useCallback(async(w,E,N,ct)=>{try{await j.createOrderItem(w,E,N,ct),O.showSuccess("Article ajouté à la commande !");const _e=await j.getOrderById(w);b(_e)}catch{O.showError("Erreur lors de l'ajout de l'article à la commande.")}},[]),B=o.useCallback(async(w,E)=>{try{if(await j.updateOrderItem(w,E),O.showSuccess("Article de commande mis à jour !"),f){const N=await j.getOrderById(f.id);b(N)}}catch{O.showError("Erreur lors de la mise à jour de l'article de commande.")}},[f]),ye=o.useCallback(async w=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer cet article de la commande ?"))try{if(await j.deleteOrderItem(w),O.showSuccess("Article de commande supprimé !"),f){const E=await j.getOrderById(f.id);b(E)}}catch{O.showError("Erreur lors de la suppression de l'article de commande.")}},[f]),U=o.useCallback(async(w,E)=>{try{if(await j.updateOrderItemStatus(w,E),O.showSuccess("Statut de l'article mis à jour !"),f){const N=await j.getOrderById(f.id);b(N)}}catch{O.showError("Erreur lors de la mise à jour du statut de l'article.")}},[f]),st=o.useCallback(async(w,E)=>{try{if(await j.updateOrderKitchenStatus(w,E),O.showSuccess("Statut de la cuisine mis à jour !"),f){const N=await j.getOrderById(f.id);b(N)}}catch{O.showError("Erreur lors de la mise à jour du statut de la cuisine.")}},[f]),ot=o.useCallback(async(w,E)=>{try{if(await j.updateOrderStatus(w,E),O.showSuccess("Statut de la commande mis à jour !"),f){const N=await j.getOrderById(f.id);b(N)}T(y)}catch{O.showError("Erreur lors de la mise à jour du statut de la commande.")}},[f,T,y]),lt=o.useCallback(async(w,E)=>{try{if(await j.updateOrderPaymentStatus(w,E),O.showSuccess("Statut de paiement mis à jour !"),f){const N=await j.getOrderById(f.id);b(N)}}catch{O.showError("Erreur lors de la mise à jour du statut de paiement.")}},[f]),ut=o.useCallback(async(w,E)=>{try{await j.linkOrderToTable(w,E),O.showSuccess("Commande liée à la table avec succès !"),T(y)}catch{O.showError("Erreur lors de la liaison de la commande à la table.")}},[T,y]),it=o.useCallback(async w=>{try{await j.unlinkOrderFromTable(w),O.showSuccess("Commande dissociée de la table avec succès !"),T(y)}catch{O.showError("Erreur lors de la dissociation de la commande de la table.")}},[T,y]);return n?m.jsx("div",{className:"text-center py-8",children:"Chargement des tables..."}):s?m.jsx("div",{className:"text-center py-8 text-red-500",children:s}):m.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[m.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Gestion des Ventes"}),m.jsx("div",{className:"flex justify-end mb-6",children:G&&m.jsxs("button",{onClick:ae,className:"flex items-center px-4 py-2 bg-brand-primary text-white rounded-md shadow-sm hover:bg-brand-dark focus:outline-none focus:ring-2 focus:ring-brand-primary focus:ring-opacity-50","aria-label":"Ajouter une nouvelle table",children:[m.jsx(pt,{className:"h-5 w-5 mr-2"}),"Ajouter Table"]})}),m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:t.length>0?t.map(w=>m.jsx(kr,{table:w,openOrderModal:W,openEditTableModal:ve,handleDeleteTable:he,canManageTables:G,canManageOrders:V},w.id)):m.jsx("p",{className:"col-span-full text-center text-gray-500",children:"Aucune table trouvée."})}),m.jsx("div",{className:"flex justify-center mt-6",children:Array.from({length:A},(w,E)=>m.jsx("button",{onClick:()=>F(E),className:`mx-1 px-3 py-1 rounded-md ${y===E?"bg-brand-primary text-white":"bg-gray-200 text-gray-700"}`,children:E+1},E))}),m.jsx(vt,{isOpen:u,onClose:()=>i(!1),onSubmit:ee,initialValues:M,mode:v,showCouvertsField:S}),c&&h&&m.jsx(bt,{isOpen:c,onClose:be,table:h,order:f,onCreateOrder:ge,onUpdateOrder:Y,onAddOrderItem:te,onUpdateOrderItem:B,onDeleteOrderItem:ye,onUpdateOrderItemStatus:U,onUpdateOrderKitchenStatus:st,onUpdateOrderStatus:ot,onUpdateOrderPaymentStatus:lt,onLinkOrderToTable:ut,onUnlinkOrderFromTable:it})]})};export{$r as default};
